<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iniciar Sesión - SocioMatch</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/iniciosesion.css">
</head>

<body>

    <header>
        <div class="container d-flex justify-content-between align-items-center py-3">
            <!-- Logo + menú -->
            <div class="d-flex align-items-center gap-4">
                <h4 class="text-primary fw-bold m-0">⚽ SocioMatch</h4>
                <!-- Botones nuevos -->

            </div>

        </div>
    </header>
    <div class="login-container">
        <h2>Iniciar Sesión</h2>
    <form id="loginForm">
        <input id="correo" type="email" class="form-control" placeholder="Correo electrónico" required>
        <input id="contraseña" type="password" class="form-control" placeholder="Contraseña" required>
        <button type="submit" class="btn btn-primary">Ingresar</button>
    </form>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
    const user = JSON.parse(localStorage.getItem('usuario'));
    if (user) {
        // Cambiar puntos
        const userPoints = document.getElementById('userPoints');
        userPoints.textContent = user.puntos;

        // Cambiar foto de perfil
        const profileImg = document.querySelector('header img');
        if(user.img_p){
            profileImg.src = `data:image/png;base64,${user.img_p}`;
        } else {
            profileImg.src = 'img/image1.png'; // fallback
        }
    }
});
const loginForm = document.getElementById('loginForm');

loginForm.addEventListener('submit', async (e) => {
    e.preventDefault();

    const correo = document.getElementById('correo').value;
    const contraseña = document.getElementById('contraseña').value;

    try {
        const response = await fetch('https://sociomatch-backend.onrender.com/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ CORREO: correo, CONTRA: contraseña })
        });

        const data = await response.json();

        if (response.ok) {
            alert('¡Bienvenido!');
            localStorage.setItem('usuario', JSON.stringify(data.user));
            // Redirigir a la página principal o dashboard
            window.location.href = 'index.html';

        } else {
            alert(data.msg);
        }

    } catch (error) {
        console.error('Error:', error);
        alert('Ocurrió un error al iniciar sesión');
    }
});
</script>


        <div class="register-link">
            ¿No tienes cuenta? <a href="registro.html">Regístrate</a>
        </div>
    </div>

    
</body>

</html>